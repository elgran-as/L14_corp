<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Detalle Departamento - L14 Corp</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/styles.css" />
</head>

<body class="bg-white text-slate-900 min-h-screen flex flex-col">
    <header class="fixed top-0 left-0 w-full bg-white border-b border-slate-200 shadow z-30">
        <div
            class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between flex-wrap sm:flex-nowrap gap-3">
            <img alt="Logo L14 Corp, estilizado con letras L14 en azul oscuro" class="h-10 w-auto" height="40"
                src="/assets/images/L14_corp.png" width="80" />
            <div class="flex items-center gap-4">
                <select aria-label="Cambiar idioma"
                    class="border border-slate-300 rounded-md text-sm py-1 px-2 focus:outline-none focus:ring-2 focus:ring-blue-600">
                    <option selected value="es">Español</option>
                    <option value="en">English</option>
                    <option value="fr">Français</option>
                    <option value="de">Deutsch</option>
                </select>
                <a href="apartments.html" class="text-blue-900 font-semibold hover:underline text-sm sm:text-base">
                    ← Volver a Departamentos
                </a>
            </div>
        </div>
    </header>
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-28 pb-20">
        <!-- Galería de imágenes -->
        <div class="image-gallery mb-8">
            <div class="main-image-container mb-4">
                <img id="mainImage" src="" alt="Imagen principal del departamento"
                    class="w-full h-64 sm:h-96 object-cover rounded-lg cursor-pointer">
            </div>
            <div id="thumbnailContainer" class="grid grid-cols-4 sm:grid-cols-6 gap-2">
                <!-- Las miniaturas se cargarán dinámicamente aquí -->
            </div>
        </div>

        <h1 class="text-3xl font-bold mb-4 text-center"></h1>
        <p class="text-slate-600 text-center mb-8"></p>

        <!-- Sección de detalles -->
        <div class="details-section mt-8">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 max-w-4xl mx-auto">
                <div class="bg-slate-50 p-6 rounded-lg">
                    <h3 class="font-semibold mb-4">Ubicación</h3>
                    <p id="addressText" class="text-slate-600"></p>
                </div>
                <div class="bg-slate-50 p-6 rounded-lg">
                    <h3 class="font-semibold mb-4">Precios</h3>
                    <ul id="pricingList" class="text-slate-600 space-y-2">
                        <!-- Los precios se cargarán dinámicamente aquí -->
                    </ul>
                </div>
            </div>
        </div>

        <!-- Características -->
        <div class="amenities-section mt-8">
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 max-w-4xl mx-auto">
                <div class="flex items-center gap-3 p-4 bg-slate-50 rounded-lg">
                    <i class="fas fa-wifi text-blue-900"></i>
                    <span>WiFi gratuito</span>
                </div>
                <div class="flex items-center gap-3 p-4 bg-slate-50 rounded-lg">
                    <i class="fas fa-swimming-pool text-blue-900"></i>
                    <span>Piscina</span>
                </div>
                <div class="flex items-center gap-3 p-4 bg-slate-50 rounded-lg">
                    <i class="fas fa-dumbbell text-blue-900"></i>
                    <span>Gimnasio</span>
                </div>
                <div class="flex items-center gap-3 p-4 bg-slate-50 rounded-lg">
                    <i class="fas fa-parking text-blue-900"></i>
                    <span>Estacionamiento incluido</span>
                </div>
            </div>
        </div>
        <div id="thumbnailContainer" class="grid grid-cols-4 sm:grid-cols-6 gap-2">
            <!-- Las miniaturas se cargarán dinámicamente aquí -->
        </div>
        <!-- Botón de reserva -->
        <div class="booking-section mt-12">
            <div class="max-w-md mx-auto bg-slate-50 p-6 rounded-lg mb-6">
                <h3 class="font-semibold mb-4 text-center">Detalles de la Reserva</h3>

                <!-- Selector de Adultos -->
                <div class="mb-4">
                    <label class="block text-slate-700 mb-2">Adultos</label>
                    <select id="adultsCount" class="w-full p-2 border border-slate-300 rounded-md">
                        <option value="1">1 Adulto</option>
                        <option value="2">2 Adultos</option>
                        <option value="3">3 Adultos</option>
                        <option value="4">4 Adultos</option>
                    </select>
                </div>

                <!-- Selector de Menores -->
                <div class="mb-4">
                    <label class="block text-slate-700 mb-2">Menores</label>
                    <select id="childrenCount" class="w-full p-2 border border-slate-300 rounded-md">
                        <option value="0">Sin menores</option>
                        <option value="1">1 Menor</option>
                        <option value="2">2 Menores</option>
                        <option value="3">3 Menores</option>
                    </select>
                    <div id="childrenAges" class="mt-3 space-y-2">
                        <!-- Las edades se agregarán dinámicamente aquí -->
                    </div>
                </div>
            </div>
            <div class="text-center">
                <button id="bookNowBtn"
                    class="bg-blue-900 text-white font-semibold px-8 py-3 rounded-lg hover:bg-blue-800 transition">
                    Reservar ahora
                </button>
            </div>
        </div>
    </main>

    <footer class="text-center text-slate-500 text-sm mb-20 px-2">
        <p>© 2025 L14 Corp. Todos los derechos reservados.</p>
        <div class="flex justify-center gap-4 mt-3">
            <a href="https://x.com/L14Corp" target="_blank" rel="noopener noreferrer"
                class="text-slate-500 hover:text-blue-900 transition-colors" aria-label="Síguenos en X (Twitter)">
                <i class="fab fa-twitter text-lg"></i>
            </a>
            <a href="https://instagram.com/L14Corp" target="_blank" rel="noopener noreferrer"
                class="text-slate-500 hover:text-blue-900 transition-colors" aria-label="Síguenos en Instagram">
                <i class="fab fa-instagram text-lg"></i>
            </a>
            <a href="https://facebook.com/L14Corp" target="_blank" rel="noopener noreferrer"
                class="text-slate-500 hover:text-blue-900 transition-colors" aria-label="Síguenos en Facebook">
                <i class="fab fa-facebook text-lg"></i>
            </a>
        </div>
    </footer>

    <nav aria-label="Navegación inferior"
        class="fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 shadow-inner z-40">
        <ul class="flex justify-around max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2 gap-3">
            <li class="flex-1">
                <a href="/index.html" title="Inicio"
                    class="flex items-center justify-center w-full py-3 text-center text-sm font-semibold rounded-md border border-transparent hover:border-blue-900 focus:outline-none transition text-slate-700 hover:text-blue-900">
                    <i class="fas fa-home text-lg"></i>
                </a>
            </li>
            <li class="flex-1">
                <a href="/pages/apartments.html" title="Departamentos"
                    class="flex items-center justify-center w-full py-3 text-center text-sm font-semibold rounded-md border border-transparent hover:border-blue-900 focus:outline-none transition text-slate-700 hover:text-blue-900">
                    <i class="fas fa-building text-lg"></i>
                </a>
            </li>
            <li class="flex-1">
                <a href="/pages/cars.html" title="Autos"
                    class="flex items-center justify-center w-full py-3 text-center text-sm font-semibold rounded-md border border-transparent hover:border-blue-900 focus:outline-none transition text-slate-700 hover:text-blue-900">
                    <i class="fas fa-car text-lg"></i>
                </a>
            </li>
            <li class="flex-1">
                <a href="#" id="planningLink" title="Planificación"
                    class="pointer-events-none opacity-50 flex items-center justify-center w-full py-3 text-center text-sm font-semibold rounded-md border border-transparent hover:border-blue-900 focus:outline-none transition text-slate-700 hover:text-blue-900">
                    <i class="fas fa-calendar-alt text-lg"></i>
                </a>
            </li>
            <li class="flex-1">
                <a href="/pages/about.html" title="Quienes Somos"
                    class="flex items-center justify-center w-full py-3 text-center text-sm font-semibold rounded-md border border-transparent hover:border-blue-900 focus:outline-none transition text-slate-700 hover:text-blue-900">
                    <i class="fas fa-info-circle text-lg"></i>
                </a>
            </li>
        </ul>
    </nav>

    <div id="apartmentModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="modalTitle" class="text-2xl font-bold mb-4"></h2>
            <p id="modalDescription" class="text-slate-700 mb-6"></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const urlParams = new URLSearchParams(window.location.search);
            const aptId = urlParams.get('id') || '1';

            const apartments = {
                '1': {
                    name: "LAF 7EN SIAN",
                    reference: "LAF 7EN 1/1",
                    building: "La Fontaine",
                    address: "1238 Drexel Ave, Miami Beach, FL 33139",
                    description: "Hermoso apartamento de 1 habitación y 1 baño en La Fontaine, Miami Beach. Totalmente amueblado y equipado.",
                    pricing: {
                        nightly: 175,
                        expenses: 0,
                        fob: 30,
                        parking: 10
                    },
                    amenities: ['Cocina completa', 'Aire acondicionado', 'WiFi', 'TV', 'Lavadora/Secadora', 'Piscina', 'Gimnasio']
                },
                '2': {
                    name: "MAM OR",
                    reference: "MAM OR 1/1",
                    building: "Marbella",
                    address: "Miami Beach, FL",
                    description: "Acogedor apartamento de 1 habitación y 1 baño en Marbella, Miami Beach. Completamente amueblado.",
                    pricing: {
                        nightly: 150,
                        expenses: 0,
                        fob: 30,
                        parking: 10
                    },
                    amenities: ['Cocina completa', 'Aire acondicionado', 'WiFi', 'TV', 'Lavadora/Secadora', 'Piscina']
                },
                '3': {
                    name: "LAF 10C SIAN",
                    reference: "LAF 10C 1/1",
                    building: "La Fontaine",
                    address: "1238 Drexel Ave, Miami Beach, FL 33139",
                    description: "Moderno apartamento de 1 habitación y 1 baño en La Fontaine, con vistas espectaculares.",
                    pricing: {
                        nightly: 175,
                        expenses: 0,
                        fob: 30,
                        parking: 10
                    },
                    amenities: ['Cocina completa', 'Aire acondicionado', 'WiFi', 'TV', 'Lavadora/Secadora', 'Piscina', 'Gimnasio']
                },
                '4': {
                    name: "MAM",
                    reference: "MAM 1/1",
                    building: "Marbella",
                    address: "Miami Beach, FL",
                    description: "Confortable apartamento de 1 habitación y 1 baño en Marbella, ideal para parejas.",
                    pricing: {
                        nightly: 150,
                        expenses: 0,
                        fob: 30,
                        parking: 10
                    },
                    amenities: ['Cocina completa', 'Aire acondicionado', 'WiFi', 'TV', 'Lavadora/Secadora', 'Piscina']
                },
                '5': {
                    name: "LAF 9R Sian",
                    reference: "LAF 9R 2/2",
                    building: "La Fontaine",
                    address: "1238 Drexel Ave, Miami Beach, FL 33139",
                    description: "Espacioso apartamento de 2 habitaciones y 2 baños en La Fontaine, perfecto para familias.",
                    pricing: {
                        nightly: 200,
                        expenses: 30,
                        fob: 30,
                        parking: 10
                    },
                    amenities: ['Cocina completa', 'Aire acondicionado', 'WiFi', 'TV', 'Lavadora/Secadora', 'Piscina', 'Gimnasio', 'Balcón']
                },
                '6': {
                    name: "LAF 4C Sian",
                    reference: "LAF 4C 1/2",
                    building: "La Fontaine",
                    address: "1238 Drexel Ave, Miami Beach, FL 33139",
                    description: "Elegante apartamento de 1 habitación y 2 baños en La Fontaine, con acabados modernos.",
                    pricing: {
                        nightly: 180,
                        expenses: 0,
                        fob: 30,
                        parking: 10
                    },
                    amenities: ['Cocina completa', 'Aire acondicionado', 'WiFi', 'TV', 'Lavadora/Secadora', 'Piscina', 'Gimnasio']
                },
                '7': {
                    name: "LAF 9M Sian",
                    reference: "LAF 9M 2/2",
                    building: "La Fontaine",
                    address: "1238 Drexel Ave, Miami Beach, FL 33139",
                    description: "Lujoso apartamento de 2 habitaciones y 2 baños en La Fontaine, con vistas panorámicas.",
                    pricing: {
                        nightly: 200,
                        expenses: 30,
                        fob: 30,
                        parking: 10
                    },
                    amenities: ['Cocina completa', 'Aire acondicionado', 'WiFi', 'TV', 'Lavadora/Secadora', 'Piscina', 'Gimnasio', 'Balcón']
                },
                '8': {
                    name: "MAM MARBELLA",
                    reference: "MAM MARBELLA 2/2",
                    building: "Marbella",
                    address: "Miami Beach, FL",
                    description: "Amplio apartamento de 2 habitaciones y 2 baños en Marbella, con servicio de limpieza incluido.",
                    pricing: {
                        nightly: 190,
                        expenses: 200,
                        fob: 0,
                        parking: 0,
                        cleaning: 200
                    },
                    amenities: ['Cocina completa', 'Aire acondicionado', 'WiFi', 'TV', 'Lavadora/Secadora', 'Piscina', 'Servicio de limpieza']
                }
            };

            function loadImages() {
                const mainImage = document.getElementById('mainImage');
                const thumbnailContainer = document.getElementById('thumbnailContainer');

                // Establecer imagen principal
                mainImage.src = `/assets/images/apartments/apt${aptId}/1.jpeg`;
                mainImage.alt = `Vista principal del departamento ${aptId}`;

                // Limpiar y cargar miniaturas
                thumbnailContainer.innerHTML = '';
                for (let i = 1; i <= 12; i++) {
                    const imgPath = `/assets/images/apartments/apt${aptId}/${i}.jpeg`;
                    const thumbnail = document.createElement('div');
                    thumbnail.className = 'cursor-pointer';

                    const img = document.createElement('img');
                    img.src = imgPath;
                    img.alt = `Vista ${i} del departamento ${aptId}`;
                    img.className = 'w-full h-16 object-cover rounded-lg hover:opacity-75 transition';

                    img.onerror = () => thumbnail.remove();

                    thumbnail.onclick = () => {
                        mainImage.src = imgPath;
                        mainImage.alt = `Vista ${i} del departamento ${aptId}`;
                    };

                    thumbnail.appendChild(img);
                    thumbnailContainer.appendChild(thumbnail);
                }
            }

            function updateDetails() {
                const aptData = apartments[aptId];
                if (!aptData) return;

                // Actualizar título y descripción
                document.querySelector('h1').innerHTML = `
                    <span class="text-lg text-blue-900">Ref: ${aptData.reference}</span><br>
                    ${aptData.building}
                `;
                document.getElementById('addressText').textContent = aptData.address;

                // Actualizar precios
                const pricingList = document.getElementById('pricingList');
                pricingList.innerHTML = '';

                if (aptData.pricing) {
                    const prices = [
                        { label: 'Por noche', value: aptData.pricing.nightly },
                        { label: 'Gastos', value: aptData.pricing.expenses },
                        { label: 'FOB (único pago)', value: aptData.pricing.fob },
                        { label: 'Estacionamiento por día', value: aptData.pricing.parking }
                    ];

                    prices.forEach(price => {
                        if (price.value) {
                            const li = document.createElement('li');
                            li.textContent = `${price.label}: $${price.value} USD`;
                            pricingList.appendChild(li);
                        }
                    });
                    function setupBookingButton() {
                        const aptData = apartments[aptId];
                        const childrenCount = document.getElementById('childrenCount');
                        const childrenAges = document.getElementById('childrenAges');

                        // Manejar cambios en el número de menores
                        childrenCount.addEventListener('change', function () {
                            const count = parseInt(this.value);
                            childrenAges.innerHTML = '';

                            for (let i = 0; i < count; i++) {
                                const ageGroup = document.createElement('div');
                                ageGroup.className = 'flex items-center gap-2 bg-white p-2 rounded';
                                ageGroup.innerHTML = `
                <label class="text-sm text-slate-600 flex-1">Edad del menor ${i + 1}:</label>
                <select class="child-age p-2 border border-slate-300 rounded-md w-24">
                    ${Array.from({ length: 18 }, (_, i) => `<option value="${i}">${i} años</option>`).join('')}
                </select>
            `;
                                childrenAges.appendChild(ageGroup);
                            }
                        });

                        // Configurar el botón de reserva
                        document.getElementById('bookNowBtn').onclick = () => {
                            const adultsCount = document.getElementById('adultsCount').value;
                            const childrenAgesArray = Array.from(document.querySelectorAll('.child-age'))
                                .map(select => select.value);

                            const queryParams = new URLSearchParams({
                                apt: aptId,
                                ref: aptData.reference,
                                name: aptData.name,
                                building: aptData.building,
                                address: aptData.address,
                                price: aptData.pricing.nightly,
                                expenses: aptData.pricing.expenses || 0,
                                fob: aptData.pricing.fob || 0,
                                parking: aptData.pricing.parking || 0,
                                cleaning: aptData.pricing.cleaning || 0,
                                adults: adultsCount,
                                children: childrenCount.value,
                                childrenAges: childrenAgesArray.join(',')
                            });

                            // Activar el enlace de planificación y establecer la URL
                            const planningLink = document.getElementById('planningLink');
                            planningLink.href = `/pages/planning.html?${queryParams.toString()}`;
                            planningLink.classList.remove('pointer-events-none', 'opacity-50');

                            // Mostrar resumen de la reserva
                            const resumenReserva = `
            Resumen de la reserva:
            - ${adultsCount} adulto(s)
            - ${childrenCount.value} menor(es)
            ${childrenAgesArray.length > 0 ? '- Edades de menores: ' + childrenAgesArray.join(', ') + ' años' : ''}
        `;

                            // Mostrar mensaje de éxito con el resumen
                            alert(resumenReserva + '\n\n¡Reserva iniciada! Ahora puedes acceder a la planificación.');
                        };
                    }
                }

                // Actualizar amenities
                const amenitiesContainer = document.querySelector('.amenities-section .grid');
                amenitiesContainer.innerHTML = '';

                const amenityIcons = {
                    'Cocina completa': 'fa-utensils',
                    'WiFi': 'fa-wifi',
                    'TV': 'fa-tv',
                    'Aire acondicionado': 'fa-snowflake',
                    'Lavadora/Secadora': 'fa-washer',
                    'Piscina': 'fa-swimming-pool',
                    'Gimnasio': 'fa-dumbbell',
                    'Estacionamiento': 'fa-parking'
                };

                aptData.amenities.forEach(amenity => {
                    const div = document.createElement('div');
                    div.className = 'flex items-center gap-3 p-4 bg-slate-50 rounded-lg';
                    div.innerHTML = `
                        <i class="fas ${amenityIcons[amenity] || 'fa-check'} text-blue-900"></i>
                        <span>${amenity}</span>
                    `;
                    amenitiesContainer.appendChild(div);
                });
            }

            function setupModal() {
                const modal = document.getElementById('apartmentModal');
                const closeModal = document.querySelector('.close-modal');
                const mainImage = document.getElementById('mainImage');
                const aptData = apartments[aptId];

                mainImage.onclick = () => {
                    modal.style.display = 'flex';
                    document.getElementById('modalTitle').textContent = aptData.name || aptData.building;
                    document.getElementById('modalDescription').textContent = aptData.description;
                };

                closeModal.onclick = () => modal.style.display = 'none';
                window.onclick = event => {
                    if (event.target === modal) modal.style.display = 'none';
                };
            }

            function setupBookingButton() {
                const aptData = apartments[aptId];
                document.getElementById('bookNowBtn').onclick = () => {
                    const queryParams = new URLSearchParams({
                        apt: aptId,
                        ref: aptData.reference,
                        building: aptData.building,
                        address: aptData.address,
                        price: aptData.pricing.nightly,
                        expenses: aptData.pricing.expenses || 0,
                        fob: aptData.pricing.fob || 0,
                        parking: aptData.pricing.parking || 0
                    });

                    window.location.href = `/pages/planning.html?${queryParams.toString()}`;
                };
            }

            // Inicializar la página
            loadImages();
            updateDetails();
            setupModal();
            setupBookingButton();
        });
    </script>
</body>

</html>